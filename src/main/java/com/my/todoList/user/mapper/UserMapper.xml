<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.my.user.mapper.UserMapper">
	<resultMap id="userMap" type="com.my.todoList.user.Users">
		<id column="USER_NO" property="userNo"/>
		<result column="id" property="id"/>
		<result column="password" property="password"/>
		<result column="email" property="email"/>
		<collection property="task" javaType="com.my.todoList.task.Task"
		resultMap=""
		>
		</collection>
	</resultMap>

	<!-- 유저등록 -->
	<insert id="insert" parameterType="com.my.todoList.user.Users">
		<selectKey resultType="Integer" keyProperty="userNo" order="BEFORE">
			SELECT users_user_no_seq.nextval FROM DUAL;
		</selectKey>
		INSERT INTO users
		VALUES(#{userNo}, #{id}, #{password}, #{email});
	</insert>
	
	<!-- 유저 수정 -->
	<update id="update" parameterType="com.my.todoList.user.Users">
		UPDATE users u
		SET u.user_id = #{id}, u.password = #{password}, u.email = #{email})
	</update>
	
	<!-- 유저 삭제 -->
	<delete id="delete" parameterType="Integer">
		DELETE FROM users
		WHERE users.user_no = #{userNo}
	</delete>
	
	<!-- 특정유저 회원정보 출력 -->
	<select id="selectUserByNo" parameterType="Integer" resultType="com.my.todoList.user.Users">
		SELECT u.user_no, u.id, u.password, u.email 
			FROM users u 
			JOIN task t
			ON 	 u.user_no = t.user_no
			WHERE u.user_no = #{userNo};
	</select>
	
		<!-- 유저 아이디로 회원정보 출력 -->
	<select id="selectUserById" parameterType="String" resultType="com.my.todoList.user.Users">
		SELECT u.user_no, u.id, u.password, u.email 
			FROM users u 
			WHERE u.id = #{Id};
	</select>
</mapper>